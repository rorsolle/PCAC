function [outputArg1,outputArg2] = compute_phi(Y, U, idx, params)

sys_params = params.sys_params;
n_y = sys_params.n_y;
n_u = sys_params.n_u;

rls_params = params.rls_params;
n_est = rls_params.n_est;

Y_vec = reshape(-Y(k-1:-1:k-n_est,:),1,[]);
U_vec = reshape(U(k:-1:k-n_est,:),1,[]);
phi = kron([Y_vec,U_vec],eye(n_y));

